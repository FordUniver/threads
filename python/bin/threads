#!/usr/bin/env bash
# Find the project root (placement independent)
script_dir="$(cd "$(dirname "$0")" && pwd)"

# Try to find pyproject.toml by searching up the directory tree
project_root=""
current="$script_dir"
while [[ "$current" != "/" ]]; do
    if [[ -f "$current/pyproject.toml" ]] && grep -q "name.*threads" "$current/pyproject.toml" 2>/dev/null; then
        project_root="$current"
        break
    fi
    current="$(dirname "$current")"
done

# Fallback: assume standard structure (bin -> ..)
if [[ -z "$project_root" ]]; then
    project_root="$(dirname "$script_dir")"
fi

cd "$project_root" && exec uv run python -m threads "$@"
